<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Pierluigi De Palo">
    <link rel="icon" href="media/favicon.ico">

    <title>Fab Academy 2015 -Pierluigi De Palo</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">

      <link href="media/Pierluigi.css" rel="stylesheet">
      
    <!-- Custom styles for this template -->
    <link href="media/fabacademy.css" rel="stylesheet">
      <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro:200,300,400,500,600,700,900' rel='stylesheet' type='text/css'>
      <link href="media/Pierluigi.css" rel="stylesheet">
      
    <!-- 3D files viewer -->
    <script type="text/javascript" src="media/jsc3d_ie.min.js"></script>
	<script type="text/javascript" src="media/jsc3d.min.js"></script>
    <script type="text/javascript" src="media/jsc3d.webgl.js"></script>
    <script type="text/javascript" src="media/jsc3d.touch.js"></script>

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="bootstrap/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="bootstrap/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!-- Load the menu file -->
    <script>
	function menu() {
					  $('#cclicense').load("license.html");
					  }
	</script>

  </head>

  <body onload="menu()">

    <!-- Static navbar -->
      
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">Home</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="about.html">About</a></li>
            <li class="dropdown">
        <a href="exercises-menu.html">Log Book</a>
              
            </li>
            <li>
        <a href="project-menu.html">Final Project</a>
            </li>
         <li><a href="extra.html">Extra</a></li>   
        </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">

	<!-- Insert your content here below! -->

 <p><font color=#fff>****************************************************************************************************************</font></p>
          
        <ul class="pager status">
    
        <li class="previous"><a href="exercise10.html">← </a></li> 
    
        <li class="next"><a href="exercise12.html"> →</a></li>
    
        <h2><font color=#fff>OUTPUT DEVICES</font></h2>

        </ul>
        

<br>
        <h4><font color=#fff>ASSIGNMENT: ADD AN OUTPUT DEVICE TO A MICROCONTROLLER YOU'VE DESIGNED AND PROGRAM IT TO DO SOMETHING</font></h4>
        <h4><font color=#fff>PROJECT 1: EX N°11 OF ARDUINO PROJECT BOOK --> CRYSTAL BALL</font></h4>
        <h4><font color=#fff>PROJECT 2: USE A SATSHA KIT MICROCONTROLLER FOR READING A LASER DISTANCE MEASUREMENT IN A LCD : MERGE 2 DIFFERENT SKETCHES</font></h4>
        <br>
        <h4><font color=#fff>INPUT: 
            <a href="http://pulsedlight3d.com/"> LIDAR LITE --> LASER DISTANCE MESUREMENT</a> // <a href="https://en.wikipedia.org/wiki/Potentiometer"> POTENTIOMETER </a>
        </font></h4>
            <h4><font color=#fff>OUTPUT:
                <a href="http://www.wvshare.com/product/LCD1602-blue.html"> LCD  LCM1602C</a>
        </font></h4>
        <h4><font color=#fff>SOFT:
            <a href="http://arduino.cc/en/Main/Software"> IDE ARDUINO 1.6.3 </a>
        </font></h4>
        <h4><font color=#fff>LIBRARY:<a href="http://www.dsscircuits.com/images/code/I2C_Rev5.zip">I2C </a></font></h4>
         <h4><font color=#fff>BOARD: SATSHAKIT  BY -->  <a href="http://fabacademy.org/archives/2015/eu/students/ingrassia.daniele/index.html">DANIELE INGRASSIA</a> // <a href="https://github.com/satshas/satshakit"> GIT HUB REPOSITORY OF THE PROJECT</a></font></h4>
        <h4><font color=#fff>DATASHEET:
            <a href="http://www.wvshare.com/product/LCD1602-blue.html">LCD  LCM1602C</a> // 
            <a href="https://s3.amazonaws.com/cdn.freshdesk.com/data/helpdesk/attachments/production/5007466446/original/LIDAR-Lite-Laser-Datasheet.pdf?AWSAccessKeyId=AKIAJ2JSYZ7O3I4JO6DA&Expires=1429631642&Signature=4i%2FJCFif41I3O8U3%2FFxnoDnHMQw%3D&response-content-type=application%2Fpdf"> LIDAR LITE </a></font></h4>
            <h4><font color=#fff>TUTORIAL: <a href="https://learn.adafruit.com/character-lcds/overview"> WRITING UP A CHARACTER LCD TO AN ARDUINO</a></font></h4>
        <h4><font color=#fff>DOWNLOAD: <a href="download/w11_Input_Lidar_Output_LCD.ino.zip"><button type="button" class="btn btn-primary btn-lg">Input Lidar Output LCD .ino</button></a></font></h4>

        
        <br>
               <p><font color=#fff>****************************************************************************************************************</font></p>
<br>
        <p class="pic">
                <img src="Images/w11_presentation_system.jpg">
	<legend></legend>
            </p> 
        
        <br>
        
        <p><font color=#fff>1ST PART --> CREATE A CRYSTAL BALL TO TELL YOUR FUTURE</font></p>

            <br>
        
        
            <p> I had followed the simple production procedure in the Arduino Project Book, Exercise 11</p>
        <p>I used this exercise to understand the use and the pin output of a LCD screen</p>
            <br>
        
        
        <p><font color=#fff>COMPONENT USED FOR THE EXERCISE : 1X POTENTIOMETERS // 1X PUSH BUTTON // 1X RESISTOR 220 ohm // 1X 10 Kilohm RESISTOR // SWITC // TILT SENSOR // LCD SCREEN</font></p>
            
        <br>    
      
        <p class="pic">
                <iframe width="960" height="540" src="https://www.youtube.com/embed/DYcvCKlGlvY?rel=0" frameborder="2" allowfullscreen></iframe>
	</p>
          <br>
          <br>
        
        
        <p><font color=#fff>2ND PART--> IMPORT I2C LIBRARY AND CONNECT THE LIDAR LASER DISTANCE MEASUREMENT TO A SATSHAKIT</font></p>
<br>
<p>After having downloaded and installed the<a href="http://www.dsscircuits.com/images/code/I2C_Rev5.zip"> Library I2C </a>  it is possible to connect the LIDAR LASER DISTANCE MESUREMENT to the SATSHAKIT</p>
        <p>Differents sketchess are available in the  <a href="https://github.com/PulsedLight3D">Git Hub Repository</a> of the Lidar Retailer.</p>
         <br> The one I used was the   <a href="https://github.com/PulsedLight3D/LIDARLite_Basics"> LIDAR LITE_BASIC</a></p>
      
      
        
        <br>
        

<p class="pic">
                <img src="Images/w11_Lidar%20Lite_Arduino%20connection%20.jpg">
	<legend></legend>
            </p> 
            <br>
      <p>For connecting the LASER to the SATSHAKIT we need to connect the SDA and SCL pins to the board</p>
      <p>Lake as possible to look in the follow images the SDA corresponding to PIN A4 and the SCL corresponding to PIN A5 in Arduino and in consequence in the SATSHAKIT </p>
            
         <br>
       <p class="pic">
                <img src="Images/w11_arduino_pin_out_modified.jpg">
	<legend></legend>
            </p> 
      <br>
      
        <p class="pic">
                <img src="Images/w11_sashakit_pin_mapping.jpg">
	<legend></legend>
            </p> 
      <br>
     
    
      <p>After  I did this, I download the <a href="https://github.com/PulsedLight3D/LIDARLite_Basics/blob/master/Arduino/LIDARLite_I2C_Library_GetDistance_ContinuousRead/LIDARLite_I2C_Library_GetDistance_ContinuousRead.ino">SKETCH</a> from the Pulsed Light 3D Git Hub repository, that uses the Arduino I2C Master Library</p>
      
      
      <br>
             <pre style="background-color: black; color: white">
            /* 

http://pulsedlight3d.com

This sketch demonstrates getting distance with the LIDAR-Lite Sensor

It utilizes the 'Arduino I2C Master Library' from DSS Circuits:
http://www.dsscircuits.com/index.php/articles/66-arduino-i2c-master-library 

You can find more information about installing libraries here:
http://arduino.cc/en/Guide/Libraries


*/

#include <I2C.h>
#define    LIDARLite_ADDRESS   0x62          // Default I2C Address of LIDAR-Lite.
#define    RegisterMeasure     0x00          // Register to write to initiate ranging.
#define    MeasureValue        0x04          // Value to initiate ranging.
#define    RegisterHighLowB    0x8f          // Register to get both High and Low bytes in 1 call.


void setup(){
  Serial.begin(9600); //Opens serial connection at 9600bps.     
  I2c.begin(); // Opens & joins the irc bus as master
  delay(100); // Waits to make sure everything is powered up before sending or receiving data  
  I2c.timeOut(50); // Sets a timeout to ensure no locking up of sketch if I2C communication fails
}

void loop(){
  // Write 0x04 to register 0x00
  uint8_t nackack = 100; // Setup variable to hold ACK/NACK resopnses     
  while (nackack != 0){ // While NACK keep going (i.e. continue polling until sucess message (ACK) is received )
    nackack = I2c.write(LIDARLite_ADDRESS,RegisterMeasure, MeasureValue); // Write 0x04 to 0x00
    delay(1); // Wait 1 ms to prevent overpolling
  }

  byte distanceArray[2]; // array to store distance bytes from read function
  
  // Read 2byte distance from register 0x8f
  nackack = 100; // Setup variable to hold ACK/NACK resopnses     
  while (nackack != 0){ // While NACK keep going (i.e. continue polling until sucess message (ACK) is received )
    nackack = I2c.read(LIDARLite_ADDRESS,RegisterHighLowB, 2, distanceArray); // Read 2 Bytes from LIDAR-Lite Address and store in array
    delay(1); // Wait 1 ms to prevent overpolling
  }
  int distance = (distanceArray[0] << 8) + distanceArray[1];  // Shift high byte [0] 8 to the left and add low byte [1] to create 16-bit int
  
  // Print Distance
  Serial.println(distance);
  delay(500);
}

</pre>

<br>
        
        
        
        <br>
        <br>
            <p><font color=#fff>3RD PART --> MODIFY AND USE THE ARDUINO SKETCH "LIQUID CRYSTAL HELLO WORLD" WITH A SATSHAKIT </font></p>
            <br>
            <p>I opened the sketch : Example ---> LiquidCrystal --> Helloworld from the example section of IDE ARDUINO </p>
            <br>
     <p class="pic">
                <img src="Images/w11_arduino_crystal_ball8.jpg">
	<legend></legend>
            </p> 
            <br>
            <br>

<p>This sketch originally used the pin A4 and A5 to connect the LCD. The same one that I need to connect the Lidar Lite Laser.</p>
<br>
<p>So I changed the original sketch address of the LCD </p>

<pre style="background-color: black; color: white">
LiquidCrystal lcd(12, 11, 5, 4, 3, 2); 
</pre>

<br>

<p>and changed it to:</p>

<br>

<pre style="background-color: black; color: white">
LiquidCrystal lcd(7, 8, 9, 10, 11, 12);
</pre>

<br>

<p>The new and modify "LIQUIDCRYSTAL HELLO WORLD" sketch is :  </p>

<br>

 <pre style="background-color: black; color: white">
 */

// include the library code:
#include <LiquidCrystal.h>

// initialize the library with the numbers of the interface pins
LiquidCrystal lcd(7, 8, 9, 10, 11, 12);

void setup() {
  // set up the LCD's number of columns and rows: 
  lcd.begin(16, 2);
  // Print a message to the LCD.
  lcd.print("hello, world!");
}

void loop() {
  // set the cursor to column 0, line 1
  // (note: line 1 is the second row, since counting begins with 0):
  lcd.setCursor(0, 1);
  // print the number of seconds since reset:
  lcd.print(millis()/1000);
}
</pre>

<br>


<br>
<p><font color=#fff> 4TH PART --> MERGE 2 SKETCHES : "LIQUIDCRYSTAL HELLO WORLD" + "LIDAR LITE BASIC"  </font><p>
<br>

<p>Now it is the moment to merge 2 sketches:  <br>I respected the fields "void setup ()" and "void loop ()" to create only one sketch.</p>
<br>
<p> I modified :</p>
<br>
<p> Removed  </p> 

<pre style="background-color: black; color: white">
lcd.print ("hello, world!")
</pre>

<br>

<p> Removed  </p>

<pre style="background-color: black; color: white">
Serial.begin(9600); 
</pre>

<br>

<p>Add "lcd.clear" line to refresh the LCD data</p>

<pre style="background-color: black; color: white">
lcd.clear();
</pre> 

                 <br>
                 
<p>Add "lcd.print" to print the 1st text</p>

 
<pre style="background-color: black; color: white">
lcd.print("DISTANCE Cm:");
</pre>

<br>

<p> Add "lcd.print" to print the 2nd text Lidar Information</p>
 
<pre style="background-color: black; color: white">
lcd.print(distance);
</pre> 

<br>

<p>Add "delay" line to reduce the data dispatch time and allow the LCD to visualize the data properly</p>

<pre style="background-color: black; color: white">
delay(500);
</pre>


<br>

<p>The result is the following sketch : -) </p>
<br>


 <pre style="background-color: black; color: white">

/*
  LiquidCrystal +  LIDAR Lite Sensor By Pierluigi De Palo // Fab Academy 2015

 Demonstrates the use a 16x2 LCD display.  The LiquidCrystal
 library works with all LCD displays that are compatible with the
 Hitachi HD44780 driver. There are many of them out there, and you
 can usually tell them by the 16-pin interface.


  The circuit:
  
  For the LCD
  
 * LCD RS pin to digital pin 7
 * LCD Enable pin to digital pin 8
 * LCD D4 pin to digital pin 9
 * LCD D5 pin to digital pin 10
 * LCD D6 pin to digital pin 11
 * LCD D7 pin to digital pin 12
 * LCD R/W pin to ground
 * LCD VSS pin to ground
 * LCD VCC pin to 5V
 * ends to +5V and ground
 * wiper to LCD VO pin (pin 3)

 Library originally added 18 Apr 2008 by David A. Mellis 
 Modified 5 Jul 2009 by Limor Fried (http://www.ladyada.net)
 Example added 9 Jul 2009 by Tom Igoe modified 22 Nov 2010 by Tom Igoe

 This example code is in the public domain. http://www.arduino.cc/en/Tutorial/LiquidCrystal
 
 For the Lidar Lite Distance Sensor:
 
 * Lidar Lite GND
 * Lidar Lite SDA
 * Lidar Lite SCL
 * Lidar Lite MODE no pin
 * Lidar Lite PWR EN no pin
 * Lidar 5V
 
 */

// include the library code:
#include <LiquidCrystal.h>

#include <I2C.h>
#define    LIDARLite_ADDRESS   0x62          // Default I2C Address of LIDAR-Lite.
#define    RegisterMeasure     0x00          // Register to write to initiate ranging.
#define    MeasureValue        0x04          // Value to initiate ranging.
#define    RegisterHighLowB    0x8f          // Register to get both High and Low bytes in 1 call.


 // initialize the library with the numbers of the interface pins
LiquidCrystal lcd(7, 8, 9, 10, 11, 12);

void setup() {
  
  lcd.begin(16, 2); // set up the LCD's number of columns and rows:
  
  I2c.begin(); // Opens & joins the irc bus as master
  delay(500); // Waits to make sure everything is powered up before sending or receiving data  
  I2c.timeOut(50); // Sets a timeout to ensure no locking up of sketch if I2C communication fails
}

void loop() {
  
   // Write 0x04 to register 0x00
  uint8_t nackack = 100; // Setup variable to hold ACK/NACK resopnses     
  while (nackack != 0){ // While NACK keep going (i.e. continue polling until sucess message (ACK) is received )
    nackack = I2c.write(LIDARLite_ADDRESS,RegisterMeasure, MeasureValue); // Write 0x04 to 0x00
    delay(1); // Wait 1 ms to prevent overpolling
  }
   byte distanceArray[2]; // array to store distance bytes from read function
  
  // Read 2byte distance from register 0x8f
  nackack = 100; // Setup variable to hold ACK/NACK resopnses     
  while (nackack != 0){ // While NACK keep going (i.e. continue polling until sucess message (ACK) is received )
    nackack = I2c.read(LIDARLite_ADDRESS,RegisterHighLowB, 2, distanceArray); // Read 2 Bytes from LIDAR-Lite Address and store in array
    delay(1); // Wait 1 ms to prevent overpolling
  }
  
  int distance = (distanceArray[0] << 8) + distanceArray[1];  // Shift high byte [0] 8 to the left and add low byte [1] to create 16-bit int
  
  
  lcd.setCursor(6, 1);  // set the cursor to column and line   // (note: line 1 is the second row, since counting begins with 0):
  lcd.clear();
  lcd.print("DISTANCE Cm:");
  lcd.print(distance); // Print Distance
  
  
  delay(500);
  
  
}



</pre>

<br>


<br>
      
        <p class="pic">
                <iframe width="960" height="540" src="https://www.youtube.com/embed/2rEiHCYe5DA?rel=0" frameborder="2" allowfullscreen></iframe>
	</p>
          <br>


    <!-- End of your content -->

    </div> <!-- /container -->

	<!-- footer -->
    
   <footer id="footer">
       
        <p class="license">
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a> <br><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Photogrammetric Fab Scanner</span> <br> by <br> <a xmlns:cc="http://creativecommons.org/ns#" href="www.pierluigidepalo.com" property="cc:attributionName" rel="cc:attributionURL"> Pierluigi De Palo </a> <br> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a><br>
            Theme: <a href="https://github.com/openp2pdesign/FabAcademy_Template">Fab Academy Template</a> by <a href="http://openp2pdesign.org">Massimo Menichinelli</a>
        </p>
    </footer>
    

	<!-- Do not touch this! -->
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="media/jquery-1.9.1.min.js"></script>
    
    <!-- Syntax Highlighter -->
    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js">
    </script>
    <!-- From https://github.com/jmblog/color-themes-for-google-code-prettify -->
    <link href="media/github.css" type="text/css" rel="stylesheet">
	<script type="text/javascript">
	  !function ($) {
		$(function(){
		  window.prettyPrint && prettyPrint()   
		})
	  }(window.jQuery)
	</script>
	
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="bootstrap/js/ie10-viewport-bug-workaround.js"></script>

  </body>
</html>
